on:
  #push:
  pull_request:
   types: [opened, synchronize]

permissions:
  contents: read
  pull-requests: write

jobs:
  init_job:
    outputs:
      output_youtrack_task_id: ${{ steps.step_of_extract_task_id.outputs.youtrack_task_id }}
    runs-on: ubuntu-20.04
    steps:
      - name : Print Title of PR
        run: | 
          echo "The Title of your PR is ${{ github.event.pull_request.title }}"
          echo "The Title of your PR is ${{ github.event.pull_request.body  }}"

      - name: Set env
        run: | 
          echo "TEST=$(echo $GITHUB_SHA | cut -c 1-6)" >> $GITHUB_ENV
          echo "Test0 == ${{ env.TEST }}"
      - name: Get env
        run: echo "Test1 == ${{ env.TEST }}"
        
      - name: Extract task id
        id: step_of_extract_task_id
        env:
          PULL_REQUEST_BODY: ${{ github.event.pull_request.body }}
        run: |
          echo "PULL_REQUEST_BODY = ${{ env.PULL_REQUEST_BODY }}"
          echo "youtrack_task_id=($(echo ${PULL_REQUEST_BODY} | grep -Eo "\[EMAM3MT5-[0-9]+" | cut -c 2-))" >> $GITHUB_OUTPUT   

  print_title_of_pr:
    runs-on: windows-latest
    needs: init_job
    steps:
    - name : Print Outputs
      run: echo "output_youtrack_task_id = ${{needs.init_job.outputs.output_youtrack_task_id}} "    
